<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <title>Rendering HTML - Elmish</title> <link rel="shortcut icon" href="/purescript-elmish/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="/purescript-elmish/assets/css/just-the-docs-default.css"> <script type="text/javascript" src="/purescript-elmish/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="/purescript-elmish/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.7.1 --> <title>Rendering HTML | Elmish</title> <meta name="generator" content="Jekyll v3.9.0" /> <meta property="og:title" content="Rendering HTML" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Elmish is a PureScript UI library that (loosely) follows The Elm Architecture implemented as a thin layer on top of React." /> <meta property="og:description" content="Elmish is a PureScript UI library that (loosely) follows The Elm Architecture implemented as a thin layer on top of React." /> <link rel="canonical" href="/purescript-elmish/dom-elements/" /> <meta property="og:url" content="/purescript-elmish/dom-elements/" /> <meta property="og:site_name" content="Elmish" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Rendering HTML" /> <script type="application/ld+json"> {"description":"Elmish is a PureScript UI library that (loosely) follows The Elm Architecture implemented as a thin layer on top of React.","headline":"Rendering HTML","@type":"WebPage","url":"/purescript-elmish/dom-elements/","@context":"https://schema.org"}</script> <!-- End Jekyll SEO tag --> </head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a href="/purescript-elmish/" class="site-title lh-tight"> Elmish </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="/purescript-elmish/" class="nav-list-link">Intro</a></li><li class="nav-list-item"><a href="/purescript-elmish/getting-started/" class="nav-list-link">Getting Started</a></li><li class="nav-list-item"><a href="/purescript-elmish/transition/" class="nav-list-link">State Transitions</a></li><li class="nav-list-item"><a href="/purescript-elmish/composition/" class="nav-list-link">Composition</a></li><li class="nav-list-item active"><a href="/purescript-elmish/dom-elements/" class="nav-list-link active">Rendering HTML</a></li><li class="nav-list-item"><a href="/purescript-elmish/read-foreign/" class="nav-list-link">JavaScript interaction</a></li><li class="nav-list-item"><a href="/purescript-elmish/react-ffi/" class="nav-list-link">Using React components</a></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Elmish" aria-label="Search Elmish" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> </div> <div id="main-content-wrap" class="main-content-wrap"> <div id="main-content" class="main-content" role="main"> <h1 class="no_toc" id="rendering-html"> <a href="#rendering-html" class="anchor-heading" aria-labelledby="rendering-html"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Rendering HTML </h1> <ol id="markdown-toc"> <li><a href="#html-elements" id="markdown-toc-html-elements">HTML elements</a></li> <li><a href="#html-attributes-aka-props" id="markdown-toc-html-attributes-aka-props">HTML attributes, aka Props</a></li> <li><a href="#content" id="markdown-toc-content">Content</a></li> <li><a href="#atomic-css-support" id="markdown-toc-atomic-css-support">Atomic CSS support</a></li> <li><a href="#event-handlers" id="markdown-toc-event-handlers">Event handlers</a></li> <li><a href="#lower-level-event-access" id="markdown-toc-lower-level-event-access">Lower-level event access</a></li> </ol> <h2 id="html-elements"> <a href="#html-elements" class="anchor-heading" aria-labelledby="html-elements"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> HTML elements </h2> <p>Elmish itself is agnostic of how views are actually rendered. It requires you to produce a <code class="language-plaintext highlighter-rouge">ReactElement</code> value, and it doesn’t care much how you do it. In fact, in the very early days, all rendering was done in JavaScript, and the resulting <code class="language-plaintext highlighter-rouge">ReactElement</code> values were FFIed back to PureScript.</p> <p>But of course it has to be done <em>somehow</em>, and the primary way it is done these days is with functions provided by <a href="https://github.com/collegevine/purescript-elmish-html">the <code class="language-plaintext highlighter-rouge">purescript-elmish-html</code> library</a>. The library provides a wide array of functions, one for every HTML element. The elements can be combined in a tree, much like one would do in regular HTML or in React+JSX.</p> <p>For example:</p> <div class="language-haskell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kr">import</span> <span class="nn">Elmish.HTML</span> <span class="k">as</span> <span class="n">H</span>

<span class="n">view</span> <span class="o">=</span>
  <span class="kt">H</span><span class="o">.</span><span class="n">div</span> <span class="p">{}</span>
  <span class="p">[</span> <span class="kt">H</span><span class="o">.</span><span class="n">h1</span> <span class="p">{}</span> <span class="s">"Welcome!"</span>
  <span class="p">,</span> <span class="kt">H</span><span class="o">.</span><span class="n">p</span> <span class="p">{}</span>
    <span class="p">[</span> <span class="kt">H</span><span class="o">.</span><span class="n">text</span> <span class="s">"This is just an example to demonstrate usage of the "</span>
    <span class="p">,</span> <span class="kt">H</span><span class="o">.</span><span class="n">a</span> <span class="p">{</span> <span class="n">href</span><span class="o">:</span> <span class="s">"https://github.com/collegevine/purescript-elmish-html"</span> <span class="p">}</span> <span class="s">"elmish-html"</span>
    <span class="p">,</span> <span class="kt">H</span><span class="o">.</span><span class="n">text</span> <span class="s">" library"</span>
    <span class="p">]</span>
  <span class="p">,</span> <span class="kt">H</span><span class="o">.</span><span class="n">img</span> <span class="p">{</span> <span class="n">src</span><span class="o">:</span> <span class="s">"/img/welcome.png"</span><span class="p">,</span> <span class="n">width</span><span class="o">:</span> <span class="mi">100</span><span class="p">,</span> <span class="n">height</span><span class="o">:</span> <span class="mi">200</span> <span class="p">}</span>
  <span class="p">,</span> <span class="kt">H</span><span class="o">.</span><span class="n">button</span> <span class="p">{</span> <span class="n">onClick</span><span class="o">:</span> <span class="n">dispatch</span> <span class="kt">Login</span> <span class="p">}</span> <span class="s">"Click here to login"</span>
  <span class="p">]</span>
</code></pre></div></div> <p>Most functions have two parameters - HTML attributes and content.</p> <h2 id="html-attributes-aka-props"> <a href="#html-attributes-aka-props" class="anchor-heading" aria-labelledby="html-attributes-aka-props"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> HTML attributes, aka Props </h2> <p>Every element may have zero or more attributes, which are passed as the first parameter, typed as a record. The types are constructed so that you can pass only a subset of all available attributes, not all of that (imagine how inconvenient that would be!)</p> <p>The attribute names and types are exactly the same as their namesakes in React. In fact, the record of attributes is just passed straight to react, without any further processing. This reduces complexity and saves some performance, but unfortunately creates some inconvenience with events.</p> <h2 id="content"> <a href="#content" class="anchor-heading" aria-labelledby="content"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Content </h2> <p>The “content”, or “inside” of the element, can be one of:</p> <ul> <li>Another element</li> <li>An array of elements</li> <li>A string</li> </ul> <p>Some elements, such as <code class="language-plaintext highlighter-rouge">img</code>, do not have a second parameter, because in HTML they are not allowed to have content.</p> <p class="callout"><strong>NOTE</strong>: Since PureScript doesn’t allow arrays of mixed types, strings need to be wrapped in <code class="language-plaintext highlighter-rouge">H.text</code> when they are mixed with other elements, as demonstrated in the example above.</p> <h2 id="atomic-css-support"> <a href="#atomic-css-support" class="anchor-heading" aria-labelledby="atomic-css-support"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Atomic CSS support </h2> <p>If you prefer Bootstrap for styling (or another atomic CSS library), you could use it exactly the same way you would in React - by passing in a <code class="language-plaintext highlighter-rouge">className</code> prop. For example:</p> <div class="language-haskell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kr">import</span> <span class="nn">Elmish.HTML</span> <span class="k">as</span> <span class="n">H</span>

<span class="n">view</span> <span class="o">=</span>
  <span class="kt">H</span><span class="o">.</span><span class="n">div</span> <span class="p">{</span> <span class="n">className</span><span class="o">:</span> <span class="s">"border bg-light"</span> <span class="p">}</span>
  <span class="p">[</span> <span class="kt">H</span><span class="o">.</span><span class="n">p</span> <span class="p">{</span> <span class="n">className</span><span class="o">:</span> <span class="s">"mt-4 mb-3"</span> <span class="p">}</span> <span class="s">"Click this button:"</span>
  <span class="p">,</span> <span class="kt">H</span><span class="o">.</span><span class="n">button</span> <span class="p">{</span> <span class="n">className</span><span class="o">:</span> <span class="s">"btn btn-primary px-4"</span><span class="p">,</span> <span class="n">onClick</span><span class="o">:</span> <span class="n">dispatch</span> <span class="kt">ButtonClicked</span> <span class="p">}</span> <span class="s">"Click me!"</span>
  <span class="p">]</span>
</code></pre></div></div> <p>But we found that this quickly becomes quite inconvenient. So the <code class="language-plaintext highlighter-rouge">elmish-html</code> library provides an alternative module <code class="language-plaintext highlighter-rouge">Elmish.HTML.Styled</code>, which exports alternative versions of all elements taking the CSS class as first parameter:</p> <div class="language-haskell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kr">import</span> <span class="nn">Elmish.HTML.Styled</span> <span class="k">as</span> <span class="n">H</span>

<span class="n">view</span> <span class="o">=</span>
  <span class="kt">H</span><span class="o">.</span><span class="n">div</span> <span class="s">"border bg-light"</span>
  <span class="p">[</span> <span class="kt">H</span><span class="o">.</span><span class="n">p</span> <span class="s">"mt-4 mb-3"</span> <span class="s">"Click this button:"</span>
  <span class="p">,</span> <span class="kt">H</span><span class="o">.</span><span class="n">button</span> <span class="s">"btn btn-primary px-4"</span> <span class="s">"Click me!"</span>
  <span class="p">]</span>
</code></pre></div></div> <p>This scheme is somewhat inspired by the <a href="https://haml.info/">HAML templates</a>, which for the example above would look something like this:</p> <div class="language-haml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">%div</span><span class="nc">.border.bg-light</span>
  <span class="nt">%p</span><span class="nc">.mt-4.mb-3</span> Click this button:
  <span class="nt">%button</span><span class="nc">.btn.btn-primary.px-4</span> Click me!
</code></pre></div></div> <p>We find this much more convenient in practice, but of course it’s stricly optional. And you can also mix and match as you wish.</p> <h3 class="no_toc" id="q-ok-but-what-if-i-need-to-pass-other-props-besides-classname"> <a href="#q-ok-but-what-if-i-need-to-pass-other-props-besides-classname" class="anchor-heading" aria-labelledby="q-ok-but-what-if-i-need-to-pass-other-props-besides-classname"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <strong>Q:</strong> ok, but what if I need to pass other props, besides <code class="language-plaintext highlighter-rouge">className</code>? </h3> <p>To facilitate this, every element in <code class="language-plaintext highlighter-rouge">Elmish.HTML.Styled</code> has two versions - e.g. <code class="language-plaintext highlighter-rouge">button</code> and <code class="language-plaintext highlighter-rouge">button_</code> (note the underscore). The former just takes CSS class as parameter, while the latter also takes other props as a record:</p> <div class="language-haskell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kr">import</span> <span class="nn">Elmish.HTML.Styled</span> <span class="k">as</span> <span class="n">H</span>

<span class="n">view</span> <span class="o">=</span>
  <span class="kt">H</span><span class="o">.</span><span class="n">div</span> <span class="s">"border bg-light"</span>
  <span class="p">[</span> <span class="kt">H</span><span class="o">.</span><span class="n">p</span> <span class="s">"mt-4 mb-3"</span> <span class="s">"Click this button:"</span>
  <span class="p">,</span> <span class="kt">H</span><span class="o">.</span><span class="n">button_</span> <span class="s">"btn btn-primary px-4"</span> <span class="p">{</span> <span class="n">onClick</span><span class="o">:</span> <span class="n">foo</span> <span class="p">}</span> <span class="s">"Click me!"</span>
  <span class="p">]</span>
</code></pre></div></div> <p>This scheme is used for all elements, even those that don’t make sense without props (such as <code class="language-plaintext highlighter-rouge">img</code> or <code class="language-plaintext highlighter-rouge">input</code>), just for consistency and predictability.</p> <h2 id="event-handlers"> <a href="#event-handlers" class="anchor-heading" aria-labelledby="event-handlers"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Event handlers </h2> <p class="callout"><strong>NOTE</strong>: the way DOM events are modeled in the <code class="language-plaintext highlighter-rouge">elmish-html</code> library is a work in progress. The API is functional, but not very ergonomic. It is subject to change in the future.</p> <p>Since the props record is passed directly to React, and in React event handlers are modeled as functions taking <a href="https://reactjs.org/docs/events.html"><code class="language-plaintext highlighter-rouge">SyntheticEvent</code></a>, the <code class="language-plaintext highlighter-rouge">elmish-html</code> library simply directly maps that to PureScript:</p> <div class="language-haskell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">onChange</span> <span class="o">::</span> <span class="kt">EffectFn1</span> <span class="kt">Foreign</span> <span class="kt">Unit</span>
</code></pre></div></div> <p>We represent the <code class="language-plaintext highlighter-rouge">SyntheticEvent</code> argument as <code class="language-plaintext highlighter-rouge">Foreign</code> in order to avoid taking <code class="language-plaintext highlighter-rouge">purescript-web-events</code> (or any other similar library) as a dependency. Our experience shows that well-typed <code class="language-plaintext highlighter-rouge">Event</code> functions are not actually useful in practice.</p> <p>A notable exception is the <code class="language-plaintext highlighter-rouge">onClick</code> event, which is represented as just:</p> <div class="language-haskell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">onClick</span> <span class="o">::</span> <span class="kt">Effect</span> <span class="kt">Unit</span>
</code></pre></div></div> <p>We chose to ignore the argument in this particular case because it’s very rarely useful in practice and most of the time ends up being ignored.</p> <h3 class="no_toc" id="q-but-if-the-event-is-just-foreign-how-do-i-get-at-its-properties"> <a href="#q-but-if-the-event-is-just-foreign-how-do-i-get-at-its-properties" class="anchor-heading" aria-labelledby="q-but-if-the-event-is-just-foreign-how-do-i-get-at-its-properties"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <strong>Q:</strong> but if the event is just <code class="language-plaintext highlighter-rouge">Foreign</code>, how do I get at its properties? </h3> <p>To do this, Elmish provides a universal way to access JavaScript data in a safe way: <code class="language-plaintext highlighter-rouge">readForeign</code>. Given expected shape of the <code class="language-plaintext highlighter-rouge">Foreign</code> object, this function can verify that the object indeed has that shape, and return it correctly typed:</p> <div class="language-haskell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">view</span> <span class="o">::</span> <span class="kt">State</span> <span class="o">-&gt;</span> <span class="kt">Dispatch</span> <span class="kt">Message</span> <span class="o">-&gt;</span> <span class="kt">ReactElement</span>
<span class="n">view</span> <span class="n">state</span> <span class="n">dispatch</span> <span class="o">=</span>
  <span class="o">...</span>
  <span class="kt">H</span><span class="o">.</span><span class="n">input_</span>
    <span class="p">{</span> <span class="kr">type</span><span class="o">:</span> <span class="s">"text"</span>
    <span class="p">,</span> <span class="n">value</span><span class="o">:</span> <span class="n">state</span><span class="o">.</span><span class="n">inputValue</span>
    <span class="p">,</span> <span class="n">onChange</span><span class="o">:</span> <span class="n">mkEffectFn1</span> <span class="nf">\</span><span class="n">foreignEvent</span> <span class="o">-&gt;</span> <span class="kr">do</span>
        <span class="kr">let</span> <span class="n">event</span> <span class="o">::</span> <span class="kt">Maybe</span> <span class="p">{</span> <span class="n">target</span> <span class="o">::</span> <span class="p">{</span> <span class="n">value</span> <span class="o">::</span> <span class="kt">String</span> <span class="p">}</span> <span class="p">}</span> <span class="o">=</span> <span class="n">readForeign</span> <span class="n">foreignEvent</span>
        <span class="kr">case</span> <span class="n">event</span> <span class="kr">of</span>
          <span class="kt">Just</span> <span class="n">e</span> <span class="o">-&gt;</span> <span class="n">dispatch</span> <span class="o">$</span> <span class="kt">InputChanged</span> <span class="n">e</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">value</span>
          <span class="kt">Noting</span> <span class="o">-&gt;</span> <span class="n">pure</span> <span class="n">unit</span> <span class="c1">-- Event did not have expected fields for some reason</span>
    <span class="p">}</span>
  <span class="o">...</span>
</code></pre></div></div> <p>Here we are specifying the expected type of <code class="language-plaintext highlighter-rouge">event</code> variable, which is <code class="language-plaintext highlighter-rouge">readForeign</code>’s result, and if it ends up as <code class="language-plaintext highlighter-rouge">Just</code>, we can be sure the event has the specified shape. Then we can just access its properties - <code class="language-plaintext highlighter-rouge">e.target.value</code>.</p> <p>But of course, this is a lot of boilerplate: the <code class="language-plaintext highlighter-rouge">mkEffectFn1</code> call, the <code class="language-plaintext highlighter-rouge">case</code> expression - all of that would be exactly the same for every event handler. So Elmish provides two operators for convenience: <code class="language-plaintext highlighter-rouge">&lt;|</code> and <code class="language-plaintext highlighter-rouge">&lt;?|</code></p> <p>The <code class="language-plaintext highlighter-rouge">&lt;|</code> operator takes care of the <code class="language-plaintext highlighter-rouge">EffectFn1</code> business. It takes the <code class="language-plaintext highlighter-rouge">dispatch</code> function on the left and an <code class="language-plaintext highlighter-rouge">event -&gt; message</code> function on the right, and takes care of piping through from one to the other:</p> <div class="language-haskell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="p">,</span> <span class="n">onChange</span><span class="o">:</span> <span class="n">dispatch</span> <span class="o">&lt;|</span> <span class="nf">\</span><span class="n">event</span> <span class="o">-&gt;</span> <span class="kt">InputChanged</span> <span class="s">"foo"</span>
</code></pre></div></div> <p>The <code class="language-plaintext highlighter-rouge">&lt;?|</code> operator does basically the same thing, except the function it takes on the right is <code class="language-plaintext highlighter-rouge">event -&gt; Maybe message</code>:</p> <div class="language-haskell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="p">,</span> <span class="n">onChange</span><span class="o">:</span> <span class="n">dispatch</span> <span class="o">&lt;?|</span> <span class="nf">\</span><span class="n">event</span> <span class="o">-&gt;</span> <span class="kr">do</span>
      <span class="n">e</span> <span class="o">::</span> <span class="p">{</span> <span class="n">target</span> <span class="o">::</span> <span class="p">{</span> <span class="n">value</span> <span class="o">::</span> <span class="kr">_</span> <span class="p">}</span> <span class="p">}</span> <span class="o">&lt;-</span> <span class="n">readForeign</span> <span class="n">event</span>
      <span class="kt">Just</span> <span class="o">$</span> <span class="kt">InputChanged</span> <span class="n">e</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">value</span>
</code></pre></div></div> <p class="callout"><strong>NOTE</strong>: Here we’re taking advantage of “type wildcards” - replacing <code class="language-plaintext highlighter-rouge">String</code> with an underscore means asking PureScript to infer it from context, which it can do from the type of <code class="language-plaintext highlighter-rouge">InputChanged</code>’s argument. Sadly, there seems to be no way to infer the whole shape of the nested records.</p> <p>In real applications that work a lot with textboxes, we usually end up defining a special-purpose function for accessing <code class="language-plaintext highlighter-rouge">event.target.value</code>:</p> <div class="language-haskell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">eventTargetValue</span> <span class="o">::</span> <span class="kt">Foreign</span> <span class="o">-&gt;</span> <span class="kt">Maybe</span> <span class="kt">String</span>
<span class="n">eventTargetValue</span> <span class="n">f</span> <span class="o">=</span>
  <span class="n">e</span> <span class="o">::</span> <span class="p">{</span> <span class="n">target</span> <span class="o">::</span> <span class="p">{</span> <span class="n">value</span> <span class="o">::</span> <span class="kr">_</span> <span class="p">}</span> <span class="p">}</span> <span class="o">&lt;-</span> <span class="n">readForeign</span> <span class="n">f</span>
  <span class="kt">Just</span> <span class="n">e</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">value</span>

<span class="o">...</span>

    <span class="p">,</span> <span class="n">onChange</span><span class="o">:</span> <span class="n">dispatch</span> <span class="o">&lt;?|</span> <span class="nf">\</span><span class="n">e</span> <span class="o">-&gt;</span> <span class="kt">InputChanged</span> <span class="o">&lt;$&gt;</span> <span class="n">eventTargetValue</span> <span class="n">e</span>

<span class="o">...</span>
</code></pre></div></div> <p>Though this function is not (yet?) part of the library.</p> <h2 id="lower-level-event-access"> <a href="#lower-level-event-access" class="anchor-heading" aria-labelledby="lower-level-event-access"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Lower-level event access </h2> <p>In extreme cases it may be necessary to access the React <code class="language-plaintext highlighter-rouge">SyntheticEvent</code> after all, even when it’s not part of the event’s type signature (such as <code class="language-plaintext highlighter-rouge">onClick</code>), for example to <code class="language-plaintext highlighter-rouge">preventDefault</code> or <code class="language-plaintext highlighter-rouge">stopPropagation</code>.</p> <p>For these cases there is currently no good solution, and we’re simply resorting to <code class="language-plaintext highlighter-rouge">unsafeCoerce</code>ing our way through it:</p> <div class="language-haskell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="o">...</span>
  <span class="p">,</span> <span class="n">onClick</span><span class="o">:</span> <span class="n">unsafeCoerce</span> <span class="o">$</span> <span class="n">mkEffectFn1</span> <span class="nf">\</span><span class="n">e</span> <span class="o">-&gt;</span> <span class="kr">do</span>
      <span class="n">stopPropagation</span> <span class="n">e</span>
      <span class="n">dispatch</span> <span class="kt">ButtonClicked</span>
  <span class="o">...</span>
</code></pre></div></div> <p>If you find yourself in need to do this, use care and make sure you understand underlying JavaScript types.</p> <hr> <footer> <p class="text-small text-grey-dk-100 mb-0">Copyright &copy; 2018-2022 CollegeVine</p> </footer> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
