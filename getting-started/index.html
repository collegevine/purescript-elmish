<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <title>Getting Started - Elmish</title> <link rel="shortcut icon" href="/purescript-elmish/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="/purescript-elmish/assets/css/just-the-docs-default.css"> <script type="text/javascript" src="/purescript-elmish/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="/purescript-elmish/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.7.1 --> <title>Getting Started | Elmish</title> <meta name="generator" content="Jekyll v3.9.0" /> <meta property="og:title" content="Getting Started" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Elmish is a PureScript UI library that (loosely) follows The Elm Architecture implemented as a thin layer on top of React." /> <meta property="og:description" content="Elmish is a PureScript UI library that (loosely) follows The Elm Architecture implemented as a thin layer on top of React." /> <link rel="canonical" href="/purescript-elmish/getting-started/" /> <meta property="og:url" content="/purescript-elmish/getting-started/" /> <meta property="og:site_name" content="Elmish" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Getting Started" /> <script type="application/ld+json"> {"description":"Elmish is a PureScript UI library that (loosely) follows The Elm Architecture implemented as a thin layer on top of React.","headline":"Getting Started","@type":"WebPage","url":"/purescript-elmish/getting-started/","@context":"https://schema.org"}</script> <!-- End Jekyll SEO tag --> </head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a href="/purescript-elmish/" class="site-title lh-tight"> Elmish </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="/purescript-elmish/" class="nav-list-link">Intro</a></li><li class="nav-list-item active"><a href="/purescript-elmish/getting-started/" class="nav-list-link active">Getting Started</a></li><li class="nav-list-item"><a href="/purescript-elmish/transition/" class="nav-list-link">State Transitions</a></li><li class="nav-list-item"><a href="/purescript-elmish/composition/" class="nav-list-link">Composition</a></li><li class="nav-list-item"><a href="/purescript-elmish/dom-elements/" class="nav-list-link">Rendering HTML</a></li><li class="nav-list-item"><a href="/purescript-elmish/read-foreign/" class="nav-list-link">JavaScript interaction</a></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Elmish" aria-label="Search Elmish" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> </div> <div id="main-content-wrap" class="main-content-wrap"> <div id="main-content" class="main-content" role="main"> <h2 id="requisite-tools"> <a href="#requisite-tools" class="anchor-heading" aria-labelledby="requisite-tools"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Requisite tools </h2> <p>Elmish is a PureScript library, and PureScript works with <a href="https://nodejs.org/en/download/">NodeJS</a>, and that’s pretty much the only tool you’ll need to install upfront.</p> <p>This tutorial assumes a basic familiarity with PureScript language as such, as well as Node and its associated tooling.</p> <h2 id="initialize-an-empty-project"> <a href="#initialize-an-empty-project" class="anchor-heading" aria-labelledby="initialize-an-empty-project"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Initialize an empty project </h2> <ol> <li>Create an empty directory, run <code class="language-plaintext highlighter-rouge">npm init</code> to initialize a new Node project. The result should be a lone <code class="language-plaintext highlighter-rouge">package.json</code> file.</li> <li>Run <code class="language-plaintext highlighter-rouge">npm install --save purescript spago react react-dom esbuild</code> to install: <ul> <li><code class="language-plaintext highlighter-rouge">purescript</code> - the PureScript compiler.</li> <li><code class="language-plaintext highlighter-rouge">spago</code> - <a href="https://github.com/purescript/spago">the PureScript package manager</a>.</li> <li><code class="language-plaintext highlighter-rouge">react</code> and <code class="language-plaintext highlighter-rouge">react-dom</code> - the React library, on which Elmish is based.</li> <li><code class="language-plaintext highlighter-rouge">esbuild</code> - the fastest JavaScript bundler currently available.</li> </ul> </li> <li>Run <code class="language-plaintext highlighter-rouge">npx spago init</code> to initialize a new PureScript project in the directory. This should create a bit of scaffolding, including a couple of <code class="language-plaintext highlighter-rouge">*.dhall</code> files and an <code class="language-plaintext highlighter-rouge">src</code> directory with <code class="language-plaintext highlighter-rouge">Main.purs</code> in it.</li> <li>Run <code class="language-plaintext highlighter-rouge">npx spago install elmish elmish-html</code> to install the Elmish library and its companion <code class="language-plaintext highlighter-rouge">elmish-html</code>.</li> </ol> <h2 id="minimal-spa-scaffolding"> <a href="#minimal-spa-scaffolding" class="anchor-heading" aria-labelledby="minimal-spa-scaffolding"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Minimal SPA scaffolding </h2> <ol> <li> <p>Using your favourite text editor, create a file named <code class="language-plaintext highlighter-rouge">index.html</code> and put the following code in it:</p> <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">"stylesheet"</span> <span class="na">href=</span><span class="s">"https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"</span><span class="nt">&gt;</span>
 <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"app"</span><span class="nt">&gt;</span>The UI is not here yet<span class="nt">&lt;/div&gt;</span>
 <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"output/index.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
 <span class="nt">&lt;script&gt;</span><span class="nb">window</span><span class="p">.</span><span class="nx">Main</span><span class="p">.</span><span class="nx">main</span><span class="p">()</span><span class="nt">&lt;/script&gt;</span>
</code></pre></div> </div> <p>The first line is the container for the application to render itself in. The second line references the JavaScript bundle (result of your code compilation). The third line invokes the PureScript entry point function.</p> <blockquote> <p><strong>Note:</strong> we’re using Bootstrap for styling. Looks better that way.</p> </blockquote> </li> <li> <p>Open <code class="language-plaintext highlighter-rouge">package.json</code>, find the <code class="language-plaintext highlighter-rouge">scripts</code> section in it, and add the following line:</p> <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nl">"start"</span><span class="p">:</span><span class="w"> </span><span class="s2">"spago build &amp;&amp; esbuild ./output/Main/index.js --bundle --serve --servedir=. --outfile=output/index.js --global-name=Main"</span><span class="w">
</span></code></pre></div> </div> <p>This command first builds your project (via <code class="language-plaintext highlighter-rouge">spago build</code>) and then starts the <code class="language-plaintext highlighter-rouge">esbuild</code> bundler to bundle the compilation results and simultaneously serve them with a built-in web server.</p> </li> <li> <p>To verify, run <code class="language-plaintext highlighter-rouge">npm start</code>. This should, after a few seconds, display something along the lines of:</p> <div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Local: http://127.0.0.1:8000/
</code></pre></div> </div> <p>Open that address in a browser. You should see text “<em>The UI is not here yet</em>”. If you don’t see that, something is wrong with the setup so far.</p> </li> </ol> <h2 id="hello-world"> <a href="#hello-world" class="anchor-heading" aria-labelledby="hello-world"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Hello World </h2> <p>To start your Elmish UI, first you’ll need to define the five elements, as explained in <a href="/purescript-elmish/">the overview</a>, - <code class="language-plaintext highlighter-rouge">State</code>, <code class="language-plaintext highlighter-rouge">Message</code>, <code class="language-plaintext highlighter-rouge">init</code>, <code class="language-plaintext highlighter-rouge">update</code>, and <code class="language-plaintext highlighter-rouge">view</code>. We’re going to put all of this in <code class="language-plaintext highlighter-rouge">Main.purs</code>:</p> <div class="language-haskell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">-- Nothing happens in our UI so far, so there are no messages</span>
<span class="kr">data</span> <span class="kt">Message</span>

<span class="c1">-- The UI is just static text, so there is no initial state</span>
<span class="kr">type</span> <span class="kt">State</span> <span class="o">=</span> <span class="kt">Unit</span>

<span class="c1">-- Since there is no state, there is nothing to initialize</span>
<span class="n">init</span> <span class="o">::</span> <span class="kt">Transition</span> <span class="kt">Message</span> <span class="kt">State</span>
<span class="n">init</span> <span class="o">=</span> <span class="n">pure</span> <span class="n">unit</span>

<span class="c1">-- Since there are no messages, the `update` function is also trivial</span>
<span class="n">update</span> <span class="o">::</span> <span class="kt">State</span> <span class="o">-&gt;</span> <span class="kt">Message</span> <span class="o">-&gt;</span> <span class="kt">Transition</span> <span class="kt">Message</span> <span class="kt">State</span>
<span class="n">update</span> <span class="kr">_</span> <span class="kr">_</span> <span class="o">=</span> <span class="n">pure</span> <span class="n">unit</span>

<span class="n">view</span> <span class="o">::</span> <span class="kt">State</span> <span class="o">-&gt;</span> <span class="kt">Dispatch</span> <span class="kt">Message</span> <span class="o">-&gt;</span> <span class="kt">ReactElement</span>
<span class="n">view</span> <span class="kr">_</span> <span class="kr">_</span> <span class="o">=</span>
   <span class="kt">H</span><span class="o">.</span><span class="n">div</span> <span class="s">"p-4"</span>
   <span class="p">[</span> <span class="kt">H</span><span class="o">.</span><span class="n">text</span> <span class="s">"Hello, "</span>
   <span class="p">,</span> <span class="kt">H</span><span class="o">.</span><span class="n">strong</span> <span class="s">""</span> <span class="s">"World!"</span>
   <span class="p">]</span>
</code></pre></div></div> <blockquote> <p><strong>Note</strong>: the <code class="language-plaintext highlighter-rouge">H.div</code> function takes CSS class as first parameter, and so does the <code class="language-plaintext highlighter-rouge">H.strong</code> function. This style works very well with Bootstrap (where most elements have a class), but it’s not the only choice. See <a href="dom-elements.md#atomic-css">DOM elements</a> for more.</p> </blockquote> <p>To make that compile, you’ll need the following imports:</p> <div class="language-haskell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kr">import</span> <span class="nn">Elmish</span> <span class="p">(</span><span class="kt">Transition</span><span class="p">,</span> <span class="kt">Dispatch</span><span class="p">,</span> <span class="kt">ReactElement</span><span class="p">)</span>
<span class="kr">import</span> <span class="nn">Elmish.HTML.Styled</span> <span class="k">as</span> <span class="n">H</span>  <span class="c1">-- This is more convenient to import qualified</span>
<span class="kr">import</span> <span class="nn">Elmish.Boot</span> <span class="p">(</span><span class="nf">defaultMain</span><span class="p">)</span> <span class="c1">-- We'll need this in a moment</span>
</code></pre></div></div> <p>Now all that remains is to hook that up to the entry point. To do that, put the following in <code class="language-plaintext highlighter-rouge">main</code>:</p> <div class="language-haskell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">main</span> <span class="o">::</span> <span class="kt">Effect</span> <span class="kt">Unit</span>
<span class="n">main</span> <span class="o">=</span> <span class="n">defaultMain</span> <span class="p">{</span> <span class="n">def</span><span class="o">:</span> <span class="p">{</span> <span class="n">init</span><span class="p">,</span> <span class="n">view</span><span class="p">,</span> <span class="n">update</span> <span class="p">},</span> <span class="n">elementId</span><span class="o">:</span> <span class="s">"app"</span> <span class="p">}</span>
</code></pre></div></div> <p>Now save and refresh your browser. Assuming you still have <code class="language-plaintext highlighter-rouge">npm start</code> running, you should see “Hello, <strong>World!</strong>” on the screen.</p> <h2 id="interaction"> <a href="#interaction" class="anchor-heading" aria-labelledby="interaction"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Interaction </h2> <p>Now let’s add some interaction. We’ll do the simplest kind for now: a button click. To do that, we’ll need a message to describe the click:</p> <div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gd">- data Message
</span><span class="gi">+ data Message = ButtonClicked
</span></code></pre></div></div> <p>And in order for the button to have a visible effect, we’ll add some state for it to change:</p> <div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gd">- type State = Unit
</span><span class="gi">+ type State = { word :: String }
</span></code></pre></div></div> <p>The <code class="language-plaintext highlighter-rouge">init</code> function should provide initial state of the right type:</p> <div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  init :: Transition Message State
<span class="gd">- init = pure unit
</span><span class="gi">+ init = pure { word: "World" }
</span></code></pre></div></div> <p>And the <code class="language-plaintext highlighter-rouge">update</code> function should react to the button click by updating the state:</p> <div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  update :: State -&gt; Message -&gt; Transition Message State
<span class="gd">- update _ _ = pure unit
</span><span class="gi">+ update state ButtonClicked = pure state { word = "Elmish" }
</span></code></pre></div></div> <p>And finally, the <code class="language-plaintext highlighter-rouge">view</code> function should add a button:</p> <div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  view :: State -&gt; Dispatch Message -&gt; ReactElement
<span class="gd">- view _ _ =
</span><span class="gi">+ view state dispatch =
</span>     H.div "p-4"
<span class="gi">+    [ H.div ""
</span>       [ H.text "Hello, "
<span class="gd">-      , H.strong "" "World!"
</span><span class="gi">+      , H.strong "" state.word
</span>       , H.text "! "
       ]
<span class="gi">+    , H.button_ "btn btn-primary mt-3" { onClick: dispatch ButtonClicked } "Click me!"
</span>     ]
</code></pre></div></div> <p>If you refresh your browser now, you should see this:</p> <p><img src="/purescript-elmish/getting-started-interaction.gif" alt="Interaction" /></p> <blockquote> <p><strong>NOTE:</strong> we just introduced the first prop (<code class="language-plaintext highlighter-rouge">onClick</code>) passed to a DOM element (<code class="language-plaintext highlighter-rouge">button</code>). For a more detailed discussion of props, see <a href="dom-elements.md">DOM elements</a>.</p> </blockquote> <h2 id="more-complex-events"> <a href="#more-complex-events" class="anchor-heading" aria-labelledby="more-complex-events"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> More complex events </h2> <p>The <code class="language-plaintext highlighter-rouge">onClick</code> event we used above is nice, but it’s a limited example of an event: it doesn’t have any parameters, but most events do.</p> <p>The <code class="language-plaintext highlighter-rouge">elmish-html</code> library models all events of standard DOM elements as an effectful function (i.e. <code class="language-plaintext highlighter-rouge">EffectFn1</code>) taking a <code class="language-plaintext highlighter-rouge">Foreign</code> parameter, even though the underlying value is actually React Synthetic Event. Mostly this is because it’s still a work in progress. Events may get a more interesting type in the future.</p> <p>But for now, the idea is to get the <code class="language-plaintext highlighter-rouge">Foreign</code> parameter and extract interesting values from it via <code class="language-plaintext highlighter-rouge">readForeign</code>, which is a standard Elmish mechanism for dealing with JS values of unknown nature (<a href="read-foreign.md">see here for more on it</a>).</p> <p>To illustrate this, let’s add a textbox to our application to let the user edit the text:</p> <div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gd">- data Message = ButtonClicked
</span><span class="gi">+ data Message
+   = ButtonClicked
+   | WordChanged String
</span>
  type State = { word :: String }

  init :: Transition Message State
  init = pure { word: "World" }

  update :: State -&gt; Message -&gt; Transition Message State
  update state ButtonClicked = pure state { word = "Elmish" }
<span class="gi">+ update state (WordChanged s) = pure state { word = s }
</span>
  view :: State -&gt; Dispatch Message -&gt; ReactElement
  view state dispatch =
    H.div "p-4"
<span class="gi">+   [ H.input_ "d-block"
+     { type: "text"
+     , value: state.word
+     , onChange: mkEffectFn1 \f -&gt; do
+         let parsed = readForeign f :: Maybe { target :: { value :: String } }
+         case parsed of
+           Nothing -&gt; pure unit
+           Just e -&gt; dispatch $ WordChanged e.target.value
+     }
</span>    , H.div "mt-3"
      [ H.text "Hello, "
      , H.strong "" state.word
      , H.text "! "
      ]
    , H.button_ "btn btn-primary mt-3" { onClick: dispatch ButtonClicked } "Click me!"
    ]
</code></pre></div></div> <p><img src="/purescript-elmish/getting-started-eventargs.gif" alt="Event Arguments" /></p> <p>But of course, this is a bit too much ceremony, so there is a special operator <code class="language-plaintext highlighter-rouge">&lt;?|</code> that takes care of the <code class="language-plaintext highlighter-rouge">case</code> and the <code class="language-plaintext highlighter-rouge">mkEffectFn1</code> parts for us:</p> <div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gd">- import Elmish (Dispatch, ReactElement, Transition)
</span><span class="gi">+ import Elmish (Dispatch, ReactElement, Transition, (&lt;?|))
</span>
...

   , onChange: dispatch &lt;?| \f -&gt;
      (readForeign f :: _ { target :: { value :: String } })
      &lt;#&gt; \e -&gt; WordChanged e.target.value
</code></pre></div></div> <p>Unfortunately, we still have to specify the shape of the record. Otherwise the compiler won’t be able to tell what we expect to find.</p> <p>For frequently used patterns like this, it’s often benefitial to extract them as a function:</p> <div class="language-haskell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">eventTargetValue</span> <span class="o">::</span> <span class="kt">Foreign</span> <span class="o">-&gt;</span> <span class="kt">Maybe</span> <span class="kt">String</span>
<span class="n">eventTargetValue</span> <span class="n">f</span> <span class="o">=</span>
   <span class="p">(</span><span class="n">readForeign</span> <span class="n">f</span> <span class="o">::</span> <span class="kr">_</span> <span class="p">{</span> <span class="n">target</span> <span class="o">::</span> <span class="p">{</span> <span class="n">value</span> <span class="o">::</span> <span class="kt">String</span> <span class="p">}</span> <span class="p">})</span>
   <span class="o">&lt;#&gt;</span> <span class="kr">_</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">value</span>

<span class="o">...</span>

   <span class="p">,</span> <span class="n">onChange</span><span class="o">:</span> <span class="n">dispatch</span> <span class="o">&lt;?|</span> <span class="nf">\</span><span class="n">f</span> <span class="o">-&gt;</span> <span class="kt">WordChanged</span> <span class="o">&lt;$&gt;</span> <span class="n">eventTargetValue</span> <span class="n">f</span>
</code></pre></div></div> <h2 id="effects"> <a href="#effects" class="anchor-heading" aria-labelledby="effects"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Effects </h2> <p>A rare UI comes without <em>effects</em> - something that happens outside the UI, be it local storage, timers, communication with a server, and so on.</p> <p>In Elmish effects are defined by the <code class="language-plaintext highlighter-rouge">update</code> function. Its return type <code class="language-plaintext highlighter-rouge">Transition Message State</code> encodes the new (“updated”) state and zero or more effects that should happen as a result of this state transition (hence the name <code class="language-plaintext highlighter-rouge">Transition</code>).</p> <p>Let’s add a simple effect as a result of our <code class="language-plaintext highlighter-rouge">ButtonClicked</code> message: output a line to the console.</p> <div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gi">+ import Effect.Class.Console (log)
</span><span class="gd">- import Elmish (Transition, Dispatch, ReactElement, (&lt;?|))
</span><span class="gi">+ import Elmish (Transition, Dispatch, ReactElement, forkVoid, (&lt;?|))
</span>
...

  update :: State -&gt; Message -&gt; Transition Message State
<span class="gd">- update state ButtonClicked = pure state { word = "Elmish" }
</span><span class="gi">+ update state ButtonClicked = do
+   forkVoid $ log "Button clicked"
+   pure state { word = "Elmish" }
</span>  update state (WordChanged s) = pure state { word = s }
</code></pre></div></div> <p>If you refresh your browser now and open console in the developer tools, you should see something like this:</p> <p><img src="/purescript-elmish/getting-started-effect-log.gif" alt="Effect: Console" /></p> <p>The <code class="language-plaintext highlighter-rouge">forkVoid</code> function adds an effect to the current state transition. The “void” suffix means that the effect does not produce any more messages.</p> <p>But most effects do eventually produce a message. Think of a server interaction: in most cases the server response has to affect the UI somehow. To achieve this, use the function <code class="language-plaintext highlighter-rouge">fork</code> (without the “void” suffix).</p> <p>Server communication is a bit too complicated for this tutorial, so let’s add a timer instead:</p> <div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gi">+ import Effect.Aff (Milliseconds(..), delay)
</span>  import Effect.Class.Console (log)
<span class="gd">- import Elmish (Dispatch, ReactElement, Transition, forkVoid, (&lt;?|))
</span><span class="gi">+ import Elmish (Dispatch, ReactElement, Transition, fork, forkVoid, (&lt;?|))
</span>
...

  data Message
    = ButtonClicked
    | WordChanged String
<span class="gi">+   | TimeoutElapsed
</span>
...

  update :: State -&gt; Message -&gt; Transition Message State
  update state ButtonClicked = do
    forkVoid $ log "Button clicked"
<span class="gi">+   fork do
+     delay $ Milliseconds 1000.0
+     pure TimeoutElapsed
</span>    pure state { word = "Elmish" }
  update state (WordChanged s) =
    pure state { word = s }
<span class="gi">+ update state TimeoutElapsed =
+   pure state { word = state.word &lt;&gt; " after a while" }
</span></code></pre></div></div> <p><img src="/purescript-elmish/getting-started-effect-timer.gif" alt="Effect: Timer" /></p> <blockquote> <p><strong>NOTE</strong>: there are many more ways to work with effects. For more information please see <a href="/purescript-elmish/transition/#effects">the page about state transitions</a></p> </blockquote> <hr> <footer> <p class="text-small text-grey-dk-100 mb-0">Copyright &copy; 2018-2022 CollegeVine</p> </footer> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
